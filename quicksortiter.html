<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <script>

        array = [5, 4, 3, 2, 1]
        quickSortIterative(array)
        console.log(array)
        var waitTime = 1000

        function resolveAfter1Second() {
            return new Promise(resolve => {
                setTimeout(function () {
                    resolve("fast")
                }, waitTime)
            })
        }

        async function quickSortIterative() {

            stack = [];
            stack.push(0);
            stack.push(array.length - 1);

            while (stack[stack.length - 1] >= 0) {

                end = stack.pop();
                start = stack.pop();


                pivot = end
                right = end
                left = start
                temp = array[right]
                array[right] = array[pivot]
                array[pivot] = temp

                i = left - 1
                for (j = left; j < right; j++) {
                    if (array[j] <= array[right]) {
                        i++
                        temp = array[j]
                        array[j] = array[i]
                        array[i] = temp
                        await resolveAfter1Second()
                        console.log(array)
                    }
                }
                i++
                temp = array[i]
                array[i] = array[right]
                array[right] = temp
                await resolveAfter1Second()
                console.log(array)
                pivotIndex = i
                end = right
                start = left


                if (pivotIndex - 1 > start) {
                    stack.push(start);
                    stack.push(pivotIndex - 1);
                }


                if (pivotIndex + 1 < end) {
                    stack.push(pivotIndex + 1);
                    stack.push(end);
                }
            }
        }
    </script>

</body>

</html>